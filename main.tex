\documentclass[a4paper]{article}

%% Language and font encodings
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amssymb}
\usepackage{amsmath}

\DeclareMathOperator*{\argmin}{\operatorname*{arg\,min}} % Jan Hlavacek

%% Sets page size and margins
\usepackage[a4paper,top=3cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

%% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}

\title{SOM}
\author{}

\begin{document}
\maketitle

\section*{SOM}

\begin{align}
	&\emph{input} && \mathbf{x}_i &&\in\mathbb{R}^M \nonumber\\
	&\emph{dataset} && \mathbf{X}=\left\{\mathbf{x}^T_0,\dots\mathbf{x}^T_n,\dots\mathbf{x}^T_N\right\}^T &&\in\mathbb{R}^{t\times N} \nonumber\\
	&\emph{prototypes} && \mathbf{W}=\left\{\mathbf{w}^T_0,\dots\mathbf{w}^T_k,\dots\mathbf{w}^T_K\right\}^T &&\in\mathbb{R}^{M \times K} \nonumber\\
    &\emph{radial bases for neighborhood} && {\phi}_{j,k} = e^{{-\gamma (j-k)^2}} && with\ \gamma=\frac{1}{2\sigma^2}\nonumber\\
    &&& \boldsymbol{\phi}_k = \{\phi_{0,k}, \dots\phi_{j,k}, \dots \phi_{K,k}\}^T && \in\mathbb{R}^{K}\nonumber\\
    &&& \boldsymbol{\Phi} = \{\boldsymbol{\phi}_0, \dots\boldsymbol{\phi}_k, \dots \boldsymbol{\phi}_K\}^T && \in\mathbb{R}^{K\times K}\nonumber\\
    &\emph{winners}&&  r_{nk} = 
   \begin{cases}
    1  & if\ k = \argmin_j ||\mathbf{x}_n - \mathbf{w}_j||\\
    0  & otherwise
  \end{cases} &&\nonumber\\
 	&\emph{cost function} && L(\mathbf{W}) = \frac{1}{2}\sum_n\sum_k \boldsymbol{\phi}_{k}||\mathbf{x}_n - \mathbf{w}_k||^2 &&   &&\nonumber\\
    &\emph{gradient}&& \Delta{\mathbf{w}_{k,t}} = -\eta\frac{\partial L(\mathbf{W})}{\partial\mathbf{w}_k} = \eta_e\boldsymbol{\phi}_{k}(\mathbf{x}_{t-1} - \mathbf{w}_{k, t-1}) &&\nonumber\\
    &\emph{learning rate decay}&&  \eta_e = \eta_0e^{-t/(\alpha\cdot epochs)} &&\nonumber\\
    &\emph{neighborhood decay}&&  \sigma_e = \sigma_0e^{-t/(\alpha\cdot epochs)} &&\nonumber   
\end{align}

\section*{Modulated SOM}

\begin{align}
	&\emph{input} && \mathbf{x}_i &&\in\mathbb{R}^M \nonumber\\
	&\emph{dataset} && \mathbf{X}=\left\{\mathbf{x}^T_0,\dots\mathbf{x}^T_n,\dots\mathbf{x}^T_N\right\}^T &&\in\mathbb{R}^{t\times N} \nonumber\\
	&\emph{prototypes} && \mathbf{W}=\left\{\mathbf{w}^T_0,\dots\mathbf{w}^T_k,\dots\mathbf{w}^T_K\right\}^T &&\in\mathbb{R}^{M \times K} \nonumber\\
    &\emph{winners}&&  r_{nk} = 
   \begin{cases}
    1  & if\ k = \argmin_j ||\mathbf{x}_n - \mathbf{w}_j||\\
    0  & otherwise
  \end{cases} &&\nonumber\\
    &\emph{performance}&&\boldsymbol{\xi}\in\mathbb{R}^{K}&&\nonumber\\
    &&&\overline{\xi} = \frac{\sum_k \xi_k}{K}&&\nonumber\\
    &\emph{radial bases for neighborhood} && {\phi}_{j,k} = \overline{\xi} e^{{-\gamma (j-k)^2}}&& with\ \gamma=\frac{1}{2{\xi_k}^2}\nonumber\\
    &&& \boldsymbol{\phi}_k = \{\phi_{0,k}, \dots\phi_{j,k}, \dots \phi_{K,k}\}^T && \in\mathbb{R}^{K}\nonumber\\
    &&& \boldsymbol{\Phi} = \{\boldsymbol{\phi}_0, \dots\boldsymbol{\phi}_k, \dots \boldsymbol{\phi}_K\}^T && \in\mathbb{R}^{K\times K}\nonumber\\
    &\emph{cost function} && L(\mathbf{W}) = \frac{1}{2}\sum_n\sum_k \phi_{n,k}||\mathbf{x}_n - \mathbf{w}_k||^2  &&\nonumber\\
    &\emph{gradient}&& \Delta{\mathbf{w}_{k,t}} = -\eta\frac{\partial L(\mathbf{W})}{\partial\mathbf{w}_k} = \eta_e\boldsymbol{\phi}_{k}(\mathbf{x}_{t-1} - \mathbf{w}_{k, t-1}) &&\nonumber
\end{align}

\section*{Generating items from a modulated SOM}
\begin{align}
	&\emph{probability distribution of each}&& &&\nonumber\\
    &\emph{cluster in the output space of the SOM} && p(y_k) = \frac{1}{\sqrt{2\pi(A\,\xi_k})^2} e^{-\frac{k^2}{2(A\,\xi_k)^2}}\nonumber\\
    &\emph{mixture probability distribution} && p(y) = \sum_k \frac{\xi_k\,p(y_k)}{\sum_j\xi_j}\nonumber\\
    &\emph{radial bases for the generation}&&\nonumber\\ 
    &\emph{of SOM activations from sample} &&\hat{\psi}_k(y) = e^{-\frac{(y-k)^2}{2\beta^2}}\nonumber\\
    & &&\psi_k(y) = \frac{\hat{\psi}_k(y)}{\sum_j{\hat{\psi}_j(y)}} \nonumber\\
    &\emph{generated pattern}&&\mathbf{x}_g = \boldsymbol{\psi}(y)\nonumber     
\end{align}

\section*{Predictor}

\begin{align}
	&\emph{input} && \mathbf{x}_i &&\in\mathbb{R}^K\nonumber\\
	&&&with\ x_{in}\in\mathbb{R}: 0\leqslant x_{in}\leqslant 1  &&\,&&\nonumber\\
	&\emph{dataset} &&\mathbf{X}=\left\{\mathbf{x}^T_0,\dots\mathbf{x}^T_n,\dots\mathbf{x}^T_N\right\}^T &&\in\mathbb{R}^{t\times N} \nonumber\\
	&\emph{weights} && \mathbf{w} &&\in\mathbb{R}^{K} \nonumber\\
	&\emph{predictions} && \mathbf{Y} = \frac{1}{1 + exp(-\mathbf{w}^T\mathbf{X})}&&\in\mathbb{R}^{K} \nonumber
\end{align}

\end{document}